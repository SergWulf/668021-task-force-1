#Процессы.

## 1. Регистрация пользователя

### Классы участвующие в процессе.
1. Класс User. Экземпляр класса соответствует строчки в базе данных в таблице users и хранит значения соответствующих столбцов в соответсвующих свойствах.
2. Класс UserService. Для каждого процесса будет сервис, отвечает за процессы: регистрация, аутэнтификация, выход с сайта, и другие процессы которые просходят с пользователем. 

### Процесс
1. Пользователь заполняет форму регистрации:email, имя, город и пароль.
2. Валидация данных из формы регистрации(при ошибках повторно отображается форма).
3. Сохранения пользователя и переадресация его на страницу аутентификации(либо сразу автоматическая аутентификация при регистрации).
---

## 2. Редактирование профиля
### Классы участвующие в процессе.
1. Класс(модель) User.
2. Класс(бизнес-логика процессов) UserService.
3. Класс(модель) Category.
4. Класс(модель) CategoryUser.
5. Класс(модель) NotificationUser. 

### Процесс
1. Пользователь редактирует форму.
2. Валидация данных из формы (при ошибках повторно отображает форму).
3. Сохранение и отображение сообщения об успешном сохранении.
---
## 3. Аутентификация пользователя
### Классы участвующие в процессе.
1. Класс(модель) User.
2. Класс(бизнес-логика процессов) UserService.

### Процесс
1. Пользователь вводит email и пароль.
2. Валидация данных из полей (при ошибках повторно отображает форму).
3. Переадресация на главную страницу личного кабинета.
---
## 4. Публикация нового задания
### Классы участвующие в процессе.
1. Класс(модель) User.
2. Класс(модель) Task.
3. Класс(бизнес-логика процессов) TaskService. Для всех процессов связанных с задачей: публикация и различные действия.
4. Класс (модель) Categories.
5. Класс (модель) CategoriesUsers.

### Процесс
1. Пользователь заполняет данные для нового задания.
2. Валидация данных из полей(при ошибках повторно отображать форму).
3. Переадресация пользователя на страницу просмотра задания.
---

## 5. Добавление отклика
### Классы участвующие в процессе.
1. Класс (модель) User.
2. Класс (модель) Task.
3. Класс(бизнес-логика процессов) TaskService. Для всех процессов связанных с задачей: публикация и различные действия.
4. Класс (модель) ResponseTask.

### Процесс
1. Пользователь при просмотре задания нажимает кнопку "Откликнуться".
2. Идёт процесс обработки события нажатия на кнопку. Если он уже откликался, то вывести сообщение об этом. 
   И никаих действий не предпринимать. Вернутся на страницу с откликами.
3. Проверка доступности. Если окажется, что другой исполнитель уже взят на выполнение задания, то вывести сообщение
   об этом. И никаих действий не предпринимать. Вернутся на страницу с откликами.
4. Всплывает модальное окно с комментарием и ценой (поля не обязательны для заполнения).
5. После нажатия на кнопку "Отправить" в модальном окне, добавляется отклик на странице отображения задания.

---

## 6. Завершение задания
### Классы участвующие в процессе.
1. Класс (модель) User.
2. Класс (модель) Task.
3. Класс(бизнес-логика процессов) TaskService. Для всех процессов связанных с задачей: публикация и различные действия.
4. Класс(модель) Review.
5. Класс(модель) NotificationUser.
6. Класс(модель) StatusTask. (Фактически меняется после статус в таблице "задачи", особо этот класс не учавствует,
   он используется только для отображения названия статуса) 
7. Класс(модель) ActionTask. (Меняет статус задачи)

### Процесс
1. На странице задания заказчик нажимает кнопку "Задание выполнено"
2. Проверка, что задание находится в нужном статусе, если по каким-то причинам это не так, то вывести сообщение об этом,
   если все хорошо, то всплывает форма и заказчик заполняет ее: оценка, комментарий..
3. Изменяется статус задачи на "Завершено", добавляется отзыв с оценкой и комментарием.
4. Отправляется уведомление исполнителю.
5. Переадресация на главную страницу(а лучше на "выполненные задания" у зазкачика).
---

## 7. Отказ от задания
### Классы участвующие в процессе.
1. Класс (модель) User.
2. Класс (модель) Task.
3. Класс(бизнес-логика процессов) TaskService. Для всех процессов связанных с задачей: публикация и различные действия.
4. Класс(модель) NotificationUser.
5. Класс(модель) StatusTask.
6. Класс(модель) ActionTask.

### Процесс
1. Исполнитель нажимается на кнопку "Отказаться".
2. Происходит проверка статуса задания, если статус не соответствует логике, или пользователь не является исполнителем,
   то вывести сообщение о этом и вернутся в исходное состояние на страницу задания.
3. Меняется статус задания на "Провалено", у исполнителя(должно ли поле быть, или на основе задания вычислять)
   меняется увеличивается счётчик провалленых заданий.
4. Отправка уведомления заказчику.
5. Переадресация на страницу просмотра задания.

---

## 8. Отмена задания
### Классы участвующие в процессе.
1. Класс (модель) User.
2. Класс (модель) Task.
3. Класс(бизнес-логика процессов) TaskService. Для всех процессов связанных с задачей: публикация и различные действия.
4. Класс(модель) StatusTask.
5. Класс(модель) ActionTask.

### Процесс
1. Заказчик нажимает кнопку "Отменить" в модальном окне "Отмена" на странице просмотра.
2. Выполнить необходимые проверки (задачу отменить может только заказчик, и только если она на исполнении).
3. Куда переадресовывать? Лучше на страницу "мои задания".

---

## 9. Старт задания
### Классы участвующие в процессе.
1. Класс (модель) User.
2. Класс (модель) Task.
3. Класс(бизнес-логика процессов) TaskService. Для всех процессов связанных с задачей: публикация и различные действия.
4. Класс(модель) ResponseTask.
5. Класс(модель) NotificationUser.
6. Класс(модель) StatusTask. (Фактически меняется после статус в таблице "задачи", особо этот класс не учавствует,
   он используется только для отображения названия статуса) 
7. Класс(модель) ActionTask. (Меняет статус задачи)

### Процесс
1. Заказчик нажимает кнопку "Принять" из списка откликов к заданию.
2. Проверка статуса задачи и исполнителя(может он уже удалил свой отклик, либо вообще удалился с сайта), если не
   проходит валидация, то вернутся на страницу с откликами(предварительно ее обновив).
3. Поменять статус задачи "На исполнении".
4. Назначить автора отклика исполнителем.
5. Отправить уведомление исполнителю.
6. Передресовать на главную страницу.

---

## 10. Отправка уведомления(отправляются с помощью email сообщений)
### Классы участвующие в процессе.
1. Класс (модель) User.
2. Класс (модель) Task.
3. Класс(бизнес-логика процессов) UserService.
4. Класс(бизнес-логика процессов) TaskService. Для всех процессов связанных с задачей: публикация и различные действия.
5. Класс(модель) ResponseTask.
6. Класс(модель) NotificationUser.
7. Класс(модель) Message.
8. Класс(модель) StatusTask. (Фактически меняется после статус в таблице "задачи", особо этот класс не учавствует,
   он используется только для отображения названия статуса) 
9. Класс(модель) ActionTask. (Меняет статус задачи)

### Процесс
1. Уведомление отправляются, если произошло следующе событие:
   - Сообщение в чате
   - Отклик к заданию
   - Отказ от задания
   - Старт задания
   - Завершение задания
3. Проверить, что у исполнителя в настройках включено получение уведомлений этого типа, если нету, 
   то остановить процесс отправки.
3. Сформировать сообщение для электронной почты:
   - Тема (событие)
   - Текст(ссылка на задание, какой-нибудь текст в зависимости от события)
4. Отправить сообщение в "Ленту событий". (Не очень понятна, где эта "Лента" в интерфейсе, а если отправлять email,
   то кто будет отправителем, сайт или адрес заказчика).
---

## 11. Отправка сообщения
### Классы участвующие в процессе.
1. Класс (модель) User.
2. Класс (модель) Task.
3. Класс(бизнес-логика процессов) UserService.
4. Класс(бизнес-логика процессов) TaskService. Для всех процессов связанных с задачей: публикация и различные действия.
5. Класс(модель) Message.
6. Класс(модель) NotificationUser.


### Процесс
1. Выполняется после отправки формы из блока "Переписка" на странице задания.
2. Валидация поля сообщения и существования id в таблице пользователей.
3. Сохранить сообщение в БД.
4. Отправить уведомление.
5. Показать страницу просмотра задания.
---

## 12. Просмотр списка заданий
### Классы участвующие в процессе.
1. Класс (модель) User.
2. Класс (модель) Task.
3. Класс(бизнес-логика процессов) TaskService. Для всех процессов связанных с задачей: публикация и различные действия.
4. Класс(модель) City.
5. Класс(модель) Category.

### Процесс
1. Пользователь заходит на страницу просмотра заданий.
2. На странице просмотра пользователь задает фильтрацию заданий.
3. Отображаются задания в зависимости от условий поиска.(Если фильтры не изменялись, то показывают все задания со
   статусом "новое", у которых адрес города совподает с адресом исполнителя).

---

## 13. Просмотр списка исполнителей
### Классы участвующие в процессе.
1. Класс (модель) User.
2. Класс (модель) Task. (По идее можно было бы исключить, но есть параметр сортировки "по числу заказов", 
   а его можно посчитать только используя данные о задачах)
3. Класс(бизнес-логика процессов) UserService.
4. Класс(бизнес-логика процессов) TaskService. Для всех процессов связанных с задачей: публикация и различные действия.
5. Класс(модель) Review.
6. Класс(модель) Category.

### Процесс
1. Пользователь заходит на страницу просмотра исполнителей. (Исполнитель тот, кто хотя бы одну категорию выбрал)
2. На странице просмотра пользователь выбирает параметры сортировки: рейтинг, число заказов и популярность.
   А также в блоке фильтров дополнительные параметры.
3. Отображаются исполнители в зависимости от условий поиска.
---

## 14. Просмотр задания
### Классы участвующие в процессе.
1. Класс (модель) User.
2. Класс (модель) Task.
3. Класс(бизнес-логика процессов) UserService.
4. Класс(бизнес-логика процессов) TaskService. Для всех процессов связанных с задачей: публикация и различные действия.
5. Класс(модель) Message.
6. Класс(модель) ResponseTask.

### Процесс
1. Пользователь заходит на страницу просмотра задания.
2. Необходимо отобразить всю информацию о задании(основная информация о задании и отклики), а также информацию,
   которая связывает исполнителя и заказчика(переписку, если она есть) и о самом заказчике.

---

## 15. Просмотр моих заданий
### Классы участвующие в процессе.
1. Класс (модель) User.
2. Класс (модель) Task.
3. Класс(бизнес-логика процессов) UserService.
4. Класс(бизнес-логика процессов) TaskService. Для всех процессов связанных с задачей: публикация и различные действия.


### Процесс
1. Пользователь заходит на страницу просмотра своих заданий.
2. В зависимости от сортировки(новые, активные, просроченные, завершенные, отмененные) необходимо отобразить
   список задач пользователя.
---





